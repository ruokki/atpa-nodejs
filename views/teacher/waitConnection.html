{% extends '../layout.html' %}
{% block content %}
    <section class="main-section">
      <div class="row">
        <div class="small-12 columns">	<!-- body -->
        	<section id="section-main" class="container container-marge">
				
        		<div id="container" class="small-10 small-centered columns text-center"> 
        			
					
					<h2>{{ session.name }}</h2>
					<h2>Clé : <span id="key">{{ session.key }}</span></h2>
					<div class="logo-atpa"><img src="/img/ATPA.png"></div>
					<div>
						<button class="large" type="button" id="go">Lancer</button>
						<p>Nombre d'étudiants connectés: <span id="nbCo"></span></p>
					</div>
				</div>
			</section>
        </div>
      </div>
    </section>
{% endblock %}

{% block script %}
<script src="/socket.io/socket.io.js"></script>
<script>
	$(document).foundation();

	var socket = io.connect('http://localhost');
	var key = $("#key").text();
	var nbCo = $("#nbCo");
	var container = $("#container");
	var indexQuestion;

	nbCo.text(0);

	socket.on('studentConnected', function(data){
		nbCo.text(data);
	});

	$("#go").click(function(e){
		e.preventDefault();
		socket.emit('launchQuestion');
		container.fadeOut(500, function(){
			container.empty();
		});
		indexQuestion = 0;
		$.ajax({
			url: '/ajax/getQuestion',
			type: 'post',
			data: {
				key: key,
				indexQuestion: indexQuestion
			},
			success: function(data) {

			}
		})

	})

</script>

{% endblock %}