{% extends '../layout.html' %}

{% block content %}
    <section class="main-section">
      <div class="row">
        <div class="small-12 columns">	<!-- body -->
        	<section id="section-main" class="container container-marge">
				
        		<div class="small-10 small-centered columns"> 
					<h1 class="text-center ">Ajout d'une question</h1>
						<form action="" method="post" name="addQuestion" role="form">
							<div class="row panel panel-form">
							    <div class="small-6  columns">
							      <label>Catégorie
							        <select name="category">
							          {% for category in categories -%}
										<option value="{{category._id}}">{{ category.label }}</option>
							          {%- endfor %}
							        </select>
							      </label>
							    </div>
							    <div class="small-6  columns">
							      <label>Type question
							        <select name="type" id="sort-type">
							          <option value="single">choix unique</option>
							          <option value="multi">choix multiple</option>
							        </select>
							      </label>
							    </div>
						  	</div>
					      	<div class="row panel panel-form">
					      		<div class="small-12 columns">
						      		<label class="hide">Question</label>
							    	<textarea placeholder="Question" name="question"></textarea>
						    	</div>
					      	</div>

					      	<div class="row">
					      		<div class="small-12 panel">
					      			<div id="input-check">
									
								      	<div class="row collapse input-multi">
											<div class="small-1 columns">
									          	<span class="prefix radius">
									          		<a class="remove-input" href="#"><i class="foundicon-remove red"></i></a>
									          	</span>
									        </div>
									        <div class="small-9 columns">
									          <input type="text" placeholder="Réponse possible" name="reponse[checkbox]">
									        </div>
									        <div class="small-2 columns">
									          	<span class="postfix radius gris-clair">
									          		<input value="0" name="checkbox[rep]" type="checkbox">
									          	</span>
									        </div>
						      			</div>
						      			<div class="row collapse input-multi">
											<div class="small-1 columns">
									          	<span class="prefix radius">
									          		<a class="remove-input" href="#"><i class="foundicon-remove red"></i></a>
									          	</span>
									        </div>
									        <div class="small-9 columns">
									          <input type="text" placeholder="Réponse possible" name="reponse[checkbox]">
									        </div>
									        <div class="small-2 columns">
									          	<span class="postfix radius gris-clair">
									          		<input value="1" name="checkbox[rep]" type="checkbox">
									          	</span>
									        </div>
						      			</div>
										<a id="add-multi-rep" class="btn-add small-1 small-offset-11"><i class="foundicon-plus"></i></a>
					      			</div>

					      			<div id="input-radio">
					      				
										<div class="row collapse input-single">
											<div class="small-1 columns">
									          	<span class="prefix radius">
									          		<a class="remove-input" href="#"><i class="foundicon-remove red"></i></a>
									          	</span>
									        </div>
									        <div class="small-9 columns">
									          <input type="text" placeholder="Réponse possible" name="reponse[radio]">
									        </div>
									        <div class="small-2 columns">
									          	<span class="postfix radius gris-clair">
									          		<input name="radio[rep]" type="radio" value="0">
									          	</span>
									        </div>
						      			</div>
						      			<div class="row collapse input-single">
											<div class="small-1 columns">
									          	<span class="prefix radius">
									          		<a class="remove-input" href="#"><i class="foundicon-remove red"></i></a>
									          	</span>
									        </div>
									        <div class="small-9 columns">
									          <input type="text" placeholder="Réponse possible" name="reponse[radio]">
									        </div>
									        <div class="small-2 columns">
									          	<span class="postfix radius gris-clair">
									          		<input name="radio[rep]" type="radio" value="1">
									          	</span>
									        </div>
						      			</div>
						      			<a id="add-single-rep" class="btn-add small-1 small-offset-11"><i class="foundicon-plus"></i></a>
								    </div>
					   			</div>
						  	</div>

						  	<div class="row panel panel-form">
							    <div class="small-6  columns">
							      <label>Timer
							        <input type="number" name="timer" placeholder="en secondes">
							      </label>
							    </div>
							    <div class="small-6  columns">
							    	<input type="submit" class="button small btn-envoi" value="Ajouter">
						    	</div>
						  	</div>
						</form>
					</section>
				</div>
			</section>
        </div>
      </div>
    </section>
{% endblock %}

{% block script %}
<script>
	    	$("document").ready(function(){
		    	$("#input-check").hide();
		    	removeInputrep();
		    	displayInputRep();
		    	addInputrep();
	    	});


	    	/**
	    	* Gestion de l'affichage des champs "réponse"
	    	**/
	    	function displayInputRep(){
	    	$("#sort-type").change(function(event){
	    	        // alert("Click event on Select has occurred!");
	    	        $("option:selected", $(this)).each(function(){
	    	            var obj = document.getElementById('sort-type').value;
	    	            // alert("selected value"+obj);

	    	            if(obj == "multi"){
	    	             $("#input-radio").hide();
	    	             $("#input-check").show();
	    	            }
	    	            else if(obj == "single"){
	    	             $("#input-check").hide();
	    	             $("#input-radio").show();
	    	            }
	    	            else{
	    	             $("#input-check").hide();
	    	             $("#input-radio").hide();
	    	            }
	    	        });
	    	   });
	    	}

	    	/**
	    	* Gestion de l'ajout des champs "réponse"
	    	**/
	    	function addInputrep(){
		    	$("#add-single-rep").click(function(){

		    	var nbInput = 0;
		    	nbInput = $(".input-single").length;

		    	var singleInput = '';
		    	singleInput = '<div class="row collapse input-single">'
		    	+'<div class="small-1 columns">'
		    		+'<span class="prefix radius">'
		    		+'<a class="remove-input" href="#">'
		    			+'<i class="foundicon-remove red"></i>'
		    		+'</a>'
		    		+'</span>'
		    	+'</div>'
		    	+'<div class="small-9 columns">'
		    		+'<input type="text" placeholder="Réponse possible" name="reponse[radio]">'
		    	+'</div>'
		    	+'<div class="small-2 columns">'
		    		+'<span class="postfix radius gris-clair">'
		    			+'<input name="radio[rep]" type="radio" value="'+nbInput+'">'
		    		+'</span>'
		    	+'</div>'
		    	+'</div>';


		    	$(singleInput).insertBefore(this);
		    	removeInputrep();
	    	});

	    	$("#add-multi-rep").click(function(){
		    	var nbInput = 0;
		    	nbInput = $(".input-multi").length;

		    	var multiInput = '<div class="row collapse input-multi">'
		    		+'<div class="small-1 columns">'
		    			+'<span class="prefix radius">'
		    				+'<a class="remove-input" href="#">'
		    					+'<i class="foundicon-remove red"></i>'
		    				+'</a>'
		    			+'</span>'
		    		+'</div>'
		    		+'<div class="small-9 columns">'
		    			+'<input type="text" placeholder="Réponse possible" name="reponse[checkbox]">'
		    		+'</div>'
		    		+'<div class="small-2 columns">'
		    			+'<span class="postfix radius gris-clair">'
		    				+'<input name="checkbox[rep]" value="'+nbInput+'" type="checkbox">'
		    			+'</span>'
		    		+'</div>'
		    	+'</div>';

		    	$(multiInput).insertBefore(this);
		    	removeInputrep();
		    	});
	    	}

	    	function removeInputrep(){
		    	$(".remove-input").off(".remove");
		    	$(".remove-input").on("click.remove", function(){
		    	$(this).parent().parent().parent().remove();
		    	});
	    	}
</script>
{% endblock %}